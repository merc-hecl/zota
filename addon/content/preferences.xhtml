<linkset>
  <html:link rel="localization" href="__addonRef__-preferences.ftl" />
</linkset>
<groupbox
  onload="Zotero.__addonInstance__.hooks.onPrefsEvent('load', { window })"
  onunload="Zotero.__addonInstance__.hooks.onPrefsEvent('unload', { window })"
>
  <vbox flex="1" style="min-height: 500px; padding: 16px">
    <!-- Provider Selection -->
    <hbox align="center" style="margin-bottom: 16px">
      <label
        for="pref-active-provider-select"
        data-l10n-id="pref-active-provider"
        style="width: 100px; text-align: right; font-weight: bold"
      ></label>
      <menulist
        id="pref-active-provider-select"
        style="flex: 1; margin-left: 12px; min-width: 200px"
      >
        <menupopup id="pref-active-provider-popup"> </menupopup>
      </menulist>
      <button
        id="pref-delete-provider"
        data-l10n-id="pref-delete-provider"
        style="margin-left: 12px; color: #c00; text-align: center"
        pack="center"
      ></button>
    </hbox>

    <html:div style="display: flex; gap: 16px; flex-wrap: wrap">
      <!-- Left Column -->
      <html:div style="flex: 1; min-width: 280px">
        <!-- Base URL (Endpoint) Dropdown -->
        <hbox align="center" style="margin-bottom: 8px">
          <label
            for="pref-provider-baseurl"
            data-l10n-id="pref-base-url"
            style="width: 100px; text-align: right"
          ></label>
          <menulist
            id="pref-provider-baseurl"
            style="flex: 1; margin-left: 8px; min-width: 150px"
            editable="true"
          >
            <menupopup id="pref-provider-baseurl-popup"> </menupopup>
          </menulist>
          <button
            id="pref-visit-website"
            data-l10n-id="pref-visit-website"
            style="margin-left: 8px; text-align: center"
            pack="center"
          ></button>
        </hbox>

        <!-- API Key Dropdown -->
        <hbox align="center" style="margin-bottom: 8px">
          <label
            for="pref-provider-apikey"
            data-l10n-id="pref-api-key"
            style="width: 100px; text-align: right"
          ></label>
          <menulist
            id="pref-provider-apikey"
            style="flex: 1; margin-left: 8px; min-width: 150px"
            editable="true"
          >
            <menupopup id="pref-provider-apikey-popup"> </menupopup>
          </menulist>
          <button
            id="pref-toggle-apikey"
            data-l10n-id="pref-show-key"
            style="margin-left: 8px; text-align: center"
            pack="center"
          ></button>
        </hbox>

        <!-- Model Selection -->
        <hbox align="center" style="margin-bottom: 8px">
          <label
            for="pref-provider-model"
            data-l10n-id="pref-model"
            style="width: 100px; text-align: right"
          ></label>
          <menulist
            id="pref-provider-model"
            style="flex: 1; margin-left: 8px; min-width: 120px"
          >
            <menupopup id="pref-provider-model-popup"> </menupopup>
          </menulist>
          <button
            id="pref-refresh-models"
            data-l10n-id="pref-refresh-models"
            style="margin-left: 8px; text-align: center"
            pack="center"
          ></button>
        </hbox>

        <!-- Model List -->
        <vbox style="margin-top: 8px; margin-bottom: 8px">
          <hbox align="center" style="margin-bottom: 4px">
            <label
              data-l10n-id="pref-model-list"
              style="width: 100px; text-align: right; font-weight: bold"
            ></label>
            <button
              id="pref-add-model-btn"
              data-l10n-id="pref-add-model"
              style="margin-left: 8px; text-align: center"
              pack="center"
            ></button>
          </hbox>
          <vbox
            id="pref-model-list"
            style="
              margin-left: 108px;
              max-height: 100px;
              overflow-y: auto;
              border: 1px solid var(--color-border, #ddd);
              border-radius: 4px;
              padding: 4px;
            "
          >
          </vbox>
        </vbox>

        <!-- Test Connection -->
        <hbox align="center" style="margin-top: 12px">
          <button
            id="pref-test-connection"
            data-l10n-id="pref-test-connection"
            style="text-align: center"
            pack="center"
          ></button>
          <label id="pref-test-result" style="margin-left: 12px"></label>
        </hbox>
      </html:div>

      <!-- Right Column -->
      <html:div style="flex: 1; min-width: 280px">
        <!-- Streaming Output -->
        <hbox align="center" style="margin-bottom: 8px">
          <label
            for="pref-streaming-output"
            data-l10n-id="pref-streaming-output"
            style="width: 100px; text-align: right"
          ></label>
          <checkbox
            id="pref-streaming-output"
            style="margin-left: 8px"
          ></checkbox>
          <label
            data-l10n-id="pref-streaming-output-hint"
            style="margin-left: 8px; opacity: 0.6; font-size: 12px"
          ></label>
        </hbox>

        <!-- Max Tokens -->
        <hbox align="center" style="margin-bottom: 8px">
          <label
            for="pref-provider-maxtokens"
            data-l10n-id="pref-max-tokens"
            style="width: 100px; text-align: right"
          ></label>
          <html:input
            type="number"
            id="pref-provider-maxtokens"
            style="width: 100px; margin-left: 8px"
          ></html:input>
          <label
            data-l10n-id="pref-max-tokens-hint"
            style="margin-left: 8px; opacity: 0.6; font-size: 12px"
          ></label>
        </hbox>

        <!-- Temperature -->
        <hbox align="center" style="margin-bottom: 8px">
          <label
            for="pref-provider-temperature"
            data-l10n-id="pref-temperature"
            style="width: 100px; text-align: right"
          ></label>
          <html:input
            type="number"
            id="pref-provider-temperature"
            style="width: 80px; margin-left: 8px"
            min="0"
            max="2"
            step="0.1"
          ></html:input>
        </hbox>

        <!-- PDF Max Chars -->
        <hbox align="center" style="margin-bottom: 8px">
          <label
            for="pref-provider-pdfmaxchars"
            data-l10n-id="pref-pdf-max-chars"
            style="width: 100px; text-align: right"
          ></label>
          <html:input
            type="number"
            id="pref-provider-pdfmaxchars"
            style="width: 100px; margin-left: 8px"
          ></html:input>
          <label
            data-l10n-id="pref-pdf-max-chars-hint"
            style="margin-left: 8px; opacity: 0.6; font-size: 12px"
          ></label>
        </hbox>

        <!-- Max Documents -->
        <hbox align="center" style="margin-bottom: 8px">
          <label
            for="pref-max-documents"
            data-l10n-id="pref-max-documents"
            style="width: 100px; text-align: right"
          ></label>
          <html:input
            type="number"
            id="pref-max-documents"
            style="width: 100px; margin-left: 8px"
            min="1"
            max="10"
          ></html:input>
          <label
            data-l10n-id="pref-max-documents-hint"
            style="margin-left: 8px; opacity: 0.6; font-size: 12px"
          ></label>
        </hbox>

        <!-- System Prompt -->
        <hbox align="start" style="margin-top: 8px; margin-bottom: 8px">
          <label
            for="pref-provider-systemprompt"
            data-l10n-id="pref-system-prompt"
            style="width: 100px; text-align: right; margin-top: 4px"
          ></label>
          <html:textarea
            id="pref-provider-systemprompt"
            style="flex: 1; height: 60px; margin-left: 8px; min-width: 200px"
          ></html:textarea>
        </hbox>
      </html:div>
    </html:div>
  </vbox>
</groupbox>
